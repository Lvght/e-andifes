<?php
include "seed/Seeder.php";

$IGNORE_ERRORS = false;

$dbReady = false;
while (!getConnection("postgres", "postgres")) {
    echo ".";
    sleep(1);
}

echo PHP_EOL;
echo "
   .=gp.
 .\'/\$\$\$\$
 || \"TP\"
 ||          .:                 ____
 ||       .-' |                /\' .\    _____
 ||    .-'    |               /: \___\  / .  /\
 ||    |      !____           \' / . / /____/..\ 
 ||    |   .-'  .-'            \/___/  \'  '\  / 
 ||    '.____.-'(                       \'__'\/
 ||     \  /  /__\
 ||      )(
|::|    /__\ 
|::|

ğŸ“  Inserindo os dados.
ğŸ—‚ï¸  Seguindo a ordem definida em interface/seed/__create__.php.\n
";

$seeder = new Seeder();
$f = include "__create__.php";

foreach ($f as $table) {
    $data = include "$table.php";
    if (!$seeder->insert($table, $data) || $IGNORE_ERRORS) {
        echo "
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢ â£†â¢€â£¶â¡¶â €â €â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢ˆâ£¿â¢¸â Ÿâ£ â£¶â¡·â €â €â €â €â €â €â €â €â €
â €â €â €â €â €â €â¢€â£€â €â¢€â£ â ´â ´â ¶â šâ ¿â ¿â ¾â ­â£¤â£€â €â €â €â €â €â €â €â €â €
â €â €â €â €â¢€â ´â¢‹â¡½â šâ ‰â €â €â €â €â €â €â €â €â €â €â ˆâ ™â ¢â£€â €â €â €â €â €â €
â €â €â¢€â¡”â â¡°â ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£´â šâ ›â£–â €â €â €â €
â €â¢€â¡â €â¡¼â¢¡â šâ¡›â ’â£„â €â €â €â €â£ â –â ›â ›â ²â¡„â â¢¯â â €â €â ¹â¡§â €â €â €
â €â£¸â €â €â¡‡â ˜â ¦â£­â¡¤â¢Ÿâ¡¤â ¤â£€â €â £â£€â¡‰â¢â£€â Ÿâ €â €â¢·â €â €â €â ™â£—â €â €
â â¢»â €â €â¢·â¢€â¡”â ‰â¢»â¡…â£€â£¤â¡ˆâ ™â ’â ºâ ¯â¡â â €â €â €â¢¸â¡†â €â €â €â ˜â¡¶â „
â €â£ˆâ£§â ´â šâ ‰â €â €â €â €â €â €â €â €â €â¢€â£°â ƒâ €â €â €â €â£¸â¡‡â €â €â €â €â ¸â£”
â£¾â ‹â €â €â €â €â €â €â €â €â €â €â €â €â €â£¿â£§â£¤â¡¤â ´â –â ‹â¢¹â ƒâ €â €â €â €â €â£·
â£¿â¡€â €â €â €â €â €â €â €â €â €â €â €â €â â£»â â €â €â €â €â €â£¿â €â €â €â €â €â €â£¼
â ™â ‘â£¤â£€â €â €â €â €â €â¢€â €â €â¢„â£â ´â ‹â €â €â €â €â €â €â ˜â¢†â €â €â €â €â£°â Ÿ
â €â €â €â£‘â¡Ÿâ ›â ›â ›â ›â ›â ›â ‰â ‰â €â €â €â €â €â €â €â €â €â €â €â €â €â¢´â¡¾â ‹â €
â €â €â €â¡¾â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˜â¡‡â €â €
â €â €â£°â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¡‡â €â €
â €â €â ¸â¡‡â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢°â ƒâ €â ƒ \n
";
        echo "âŒ  ->$table<- falhou no processo de inserÃ§Ã£o dos dados. Verifique o erro acima. Boa sorte!\n";
        echo "â„¹ï¸  VocÃª tambÃ©m pode definir \$IGNORE_ERRORS para true e tentar subir a interface mesmo assim.\n";
        echo "â„¹ï¸  Verifique o arquivo interface/seed/__entrypoint__.php para fazer isso.\n";
        return -1;
    }
    echo "âœ… $table\n";
}

shell_exec("php -S 0.0.0.0:8000 -t public/");
